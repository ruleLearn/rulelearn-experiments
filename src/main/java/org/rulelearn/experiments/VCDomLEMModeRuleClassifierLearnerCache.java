/**
 * 
 */
package org.rulelearn.experiments;

import java.util.HashMap;
import java.util.Map;

import org.rulelearn.rules.RuleSetWithComputableCharacteristics;

/**
 * Caches rules generated by {@link VCDomLEMModeRuleClassifierLearner} for many data sets and single consistency threshold for each of these data sets (so they can be used several times).
 * 
 * @author Marcin SzelÄ…g (<a href="mailto:marcin.szelag@cs.put.poznan.pl">marcin.szelag@cs.put.poznan.pl</a>)
 */
public class VCDomLEMModeRuleClassifierLearnerCache {
	
	static private VCDomLEMModeRuleClassifierLearnerCache instance = null;
	
	static VCDomLEMModeRuleClassifierLearnerCache getInstance() {
		if (instance == null) {
			instance = new VCDomLEMModeRuleClassifierLearnerCache();
		}
		return instance;
	}
	
	Map<String, Map<Double, RuleSetWithComputableCharacteristics>> dataSetName2ConsistencyThresholdVSRulesMap = new HashMap<String, Map<Double,RuleSetWithComputableCharacteristics>>();
	
	public RuleSetWithComputableCharacteristics getRules(String dataSetName, double consistencyThreshold) { //can return null
		RuleSetWithComputableCharacteristics result = null;
		
		if (dataSetName2ConsistencyThresholdVSRulesMap.containsKey(dataSetName)) {
			if (dataSetName2ConsistencyThresholdVSRulesMap.get(dataSetName).containsKey(consistencyThreshold)) {
				result = dataSetName2ConsistencyThresholdVSRulesMap.get(dataSetName).get(consistencyThreshold);
			}
		}
		
		return result;
	}
	
	public void putRules(String dataSetName, double consistencyThreshold, RuleSetWithComputableCharacteristics rules) {
		Map<Double, RuleSetWithComputableCharacteristics> consistencyThreshold2RulesMap = new HashMap<Double, RuleSetWithComputableCharacteristics>();
		consistencyThreshold2RulesMap.put(consistencyThreshold, rules);
		
		dataSetName2ConsistencyThresholdVSRulesMap.put(dataSetName, consistencyThreshold2RulesMap);
	}
	
	public void clear() {
		dataSetName2ConsistencyThresholdVSRulesMap = new HashMap<String, Map<Double,RuleSetWithComputableCharacteristics>>(); //clear map to free memory
	}
	
	public void clear(String dataSetName) {
		dataSetName2ConsistencyThresholdVSRulesMap.remove(dataSetName); //clears cache for the given data set name (leaving other mappings, e.g., for other fold train data)
	}

}
